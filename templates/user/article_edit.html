{% extends "user/base_user.html" %}

{% block title %}{% if article_id %}编辑文章{% else %}新建文章{% endif %} - 用户中心{% endblock %}

{% block content %}
<div class="p-6">
          <!-- 页面标题和操作按钮 -->
          <div class="flex justify-between items-center mb-6">
            <div>
              <h1 class="text-2xl font-bold text-gray-800">
                {% if article_id %}编辑文章{% else %}新建文章{% endif %}
              </h1>
              <p class="text-gray-600">{% if article_id %}修改您的文章内容{% else %}创建新的文章内容{% endif %}</p>
            </div>
            <div class="flex space-x-3">
              <a href="/user/articles" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200">
                <i class="fas fa-arrow-left"></i>
                <span>返回列表</span>
              </a>
              <button id="save-article-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200">
                <i class="fas fa-save"></i>
                <span>保存文章</span>
              </button>
            </div>
          </div>

          <!-- 文章编辑表单 -->
          <div class="bg-white rounded-lg shadow p-6">
            <form id="article-form" class="space-y-6">
              <!-- 文章标题 -->
              <div>
                <label for="article-title" class="block text-sm font-medium text-gray-700 mb-2">
                  文章标题 <span class="text-red-500">*</span>
                </label>
                <input type="text" id="article-title" name="title" maxlength="100" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="请输入文章标题（最多100个字符）">
                <div class="text-xs text-gray-500 mt-1">
                  <span id="title-count">0</span>/100 字符
                </div>
              </div>

              <!-- 文章分类和排序编号（同一行显示） -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- 文章分类 -->
                <div>
                  <label for="article-category" class="block text-sm font-medium text-gray-700 mb-2">
                    文章分类 <span class="text-red-500">*</span>
                  </label>
                  <select id="article-category" name="cate_id" 
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">请选择文章分类</option>
                    <!-- 分类选项将通过JavaScript动态加载 -->
                  </select>
                </div>

                <!-- 排序编号 -->
                <div>
                  <label for="article-order" class="block text-sm font-medium text-gray-700 mb-2">
                    排序编号
                  </label>
                  <input type="number" id="article-order" name="order_id" value="100" 
                         class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                         placeholder="请输入排序编号">
                  <div class="text-xs text-gray-500 mt-1">
                    数字越大，排序越靠前
                  </div>
                </div>
              </div>

              <!-- 文章内容 -->
              <div>
                <label for="editor1" class="block text-sm font-medium text-gray-700 mb-2">
                  文章内容 <span class="text-red-500">*</span>
                </label>
                <textarea name="editor1" id="editor1"></textarea>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 加载状态提示 -->
  <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg p-6">
      <div class="flex items-center space-x-3">
        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"></div>
        <span>正在保存...</span>
      </div>
    </div>
  </div>

  <!-- 引入JavaScript文件 -->
  <!-- 加载jQuery -->
  <script src="{{ url_for('static', filename='js/jquery-3.6.0.min.js') }}"></script>
  <!-- 加载CKEditor核心文件 -->
  <script src="{{ url_for('static', filename='ckeditor/ckeditor.js') }}"></script>
  <!-- 加载jQuery适配器 -->
  <script src="{{ url_for('static', filename='ckeditor/adapters/jquery.js') }}"></script>
  <!-- 页面初始化脚本 -->
  <script src="{{ url_for('static', filename='js/user/article_edit.js') }}"></script>
{% endblock %}